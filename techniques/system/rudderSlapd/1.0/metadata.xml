<TECHNIQUE name="Rudder slapd">
  <DESCRIPTION>Configure the rudder-slapd service</DESCRIPTION>
  <MULTIINSTANCE>false</MULTIINSTANCE>
  <USEMETHODREPORTING>true</USEMETHODREPORTING>

  <AGENT type="cfengine-community">
    <BUNDLES>
      <NAME>system_rudder_slapd_configuration</NAME>
    </BUNDLES>
    <TMLS>
      <TML name="main"/>
    </TMLS>
  </AGENT>

  <SECTIONS>
    <SECTION name="Rudder slapd service" multivalued="true" component="true">
      <REPORTKEYS>
        <VALUE>Started</VALUE>
        <VALUE>Enabled</VALUE>
      </REPORTKEYS>
    </SECTION>
    <SECTION name="Rudder slapd configuration" multivalued="true" component="true">
      <INPUT>
        <NAME>RUDDER_LDAP_PASSWORD</NAME>
        <DESCRIPTION>Ldap password</DESCRIPTION>
      </INPUT>
      <REPORTKEYS>
        <VALUE>Check Rudder ldap password</VALUE>
        <VALUE>Check Rudder ldap permissions</VALUE>
      </REPORTKEYS>
    </SECTION>
  </SECTIONS>
</TECHNIQUE>
